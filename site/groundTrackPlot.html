

<!doctype html>
<html>
<head>
  <meta charset="utf8">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1">
  <title>在线绘制星下点轨迹</title>
<link rel="stylesheet" href="https://cdn.bootcss.com/jquery-mobile/1.4.5/jquery.mobile.min.css">
<script src="https://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/jquery-mobile/1.4.5/jquery.mobile.min.js"></script>
<script src="https://cdn.bootcss.com/mathjs/4.0.1/math.min.js"></script>
<script src="./js/orbitState.js"></script>
</head>



<body>
<div data-role="page">
    <div data-role="header">
      <h1>在线绘制星下点轨迹</h1>
    </div

    <div id="pageone" data-role="main" class="ui-content">
        <div data-role="fieldcontain">
            <label for="iSMA">半长轴(KM)</label>
            <input type="text" name="iSMA" id="iSMA" data-clear-btn="true">
            <label for="ECC">离心率</label>
            <input type="text" name="iECC" id="iECC" data-clear-btn="true">
            <label for="iINC">轨道倾角(°)</label>
            <input type="text" name="iINC" id="iINC" data-clear-btn="true">
            <label for="iAOP">近地点角距(°)</label>
            <input type="text" name="iAOP" id="iAOP" data-clear-btn="true">
            <label for="iRAAN">升交点赤经(°)</label>
            <input type="text" name="iRAAN" id="iRAAN" data-clear-btn="true">
            <label for="iTA">真近点角(°)</label>
            <input type="text" name="iTA" id="iTA" data-clear-btn="true">
            <label for="iN">运行周期（可以是小数）</label>
            <input type="text" name="iN" id="iN" data-clear-btn="true">
            <label for="iNPLOT">绘图的散点数（与精度无关）</label>
            <input type="text" name="iNPLOT" id="iNPLOT" data-clear-btn="true">
            </div>

            <button cols="60" rows="10" type="button" class="btn btn-default"  onclick = "plotGroundTrack()">绘制星下点轨迹</button>
  
      <div id="main" style="width: 100%;height:67%"></div>
      <div data-role="popup" id="myPopup">
        <p>需要专业版程序请加QQ</p> 
      </div>
    </div>

  <div data-role="footer" style="text-align:center;">
    <h1>为了减少您的流量消耗，并提高访问速度，<br>仅提供静拉力和功率的的查询。</h1>
    <a href="#myPopup" data-rel="popup" data-position-to="window">专业版程序点这里</a>
  </div>
</div>
</body>

<script src="https://cdn.bootcss.com/echarts/4.0.4/echarts.min.js"></script>


<script type="text/javascript">
$('#iSMA').val('8576');
$('#iECC').val(0.241);
$('#iINC').val(112.228);
$('#iAOP').val(19.6);
$('#iRAAN').val(120.671);
$('#iTA').val(25.325);
$('#iN').val(1);
$('#iNPLOT').val(1000);

function plotGroundTrack(){
  var a = Number($('#iSMA').val()) * 1000.0;
  //window.alert("PERIOD = " + 2 * pi * Math.pow(a*a*a/mu,0.5));
  var time = 2 * pi * Math.pow(a*a*a/mu,0.5) * Number($('#iN').val())
  var orbit1 = new orbit(Number($('#iSMA').val() * 1000.0),
                     Number($('#iECC').val()),
                     Number($('#iINC').val() * radPerDeg),
                     Number($('#iAOP').val() * radPerDeg),
                     Number($('#iRAAN').val() * radPerDeg),
                     Number($('#iTA').val()) * radPerDeg);
  var worldMapContainer = document.getElementById('main');

  var allData = orbit1.getGroundTrack(time);
  //window.alert(time);
  //window.alert(allData);

  

  //用于使chart自适应高度和宽度,通过窗体高宽计算容器高宽
  var resizeWorldMapContainer = function () {
      worldMapContainer.style.width = window.innerWidth+'px';
      worldMapContainer.style.height = window.innerHeight+'px';
  };
  resizeWorldMapContainer();
  var myChart = echarts.init(worldMapContainer);
  window.onresize = function () {
    //重置容器高宽
    resizeWorldMapContainer();
    myChart.resize();
  };

  $.get('world.json', function (chinaJson) {
    echarts.registerMap('world', chinaJson);
    var chart = myChart;
    chart.setOption({
      tooltip: {},
      legend: {
                //data:['拉力']
      },
      geo:{
        map:'world'
      },
      series: [
      {
        name: '星下点轨迹', // series名称
        symbolSize: 3,
        type: 'scatter', // series图表类型
        coordinateSystem: 'geo', // series坐标系类型
        data : allData
      }
	    ]
    });
  });
}
</script>

<!-- 为ECharts准备一个具备大小（宽高）的Dom -->
    
<script type="text/javascript">
plotWorldMap();
function plotWorldMap(){
  var worldMapContainer = document.getElementById('main');
  

  //用于使chart自适应高度和宽度,通过窗体高宽计算容器高宽
  var resizeWorldMapContainer = function () {
      worldMapContainer.style.width = window.innerWidth+'px';
      worldMapContainer.style.height = window.innerHeight+'px';
  };
  resizeWorldMapContainer();
  var myChart = echarts.init(worldMapContainer);
  window.onresize = function () {
    //重置容器高宽
    resizeWorldMapContainer();
    myChart.resize();
  };

  $.get('world.json', function (chinaJson) {
    echarts.registerMap('world', chinaJson);
    var chart = myChart;
    chart.setOption({
      geo:{
        map:'world'
      },
      series: [
      {
        name: '销量', // series名称
        symbolSize: 5,
        type: 'scatter', // series图表类型
        coordinateSystem: 'geo', // series坐标系类型
        //data : [[0,0],[90,0],[45,45],[180,0],[-45,-45],[200,0]]
      }
	    ]
    });
  });
}
  //myChart.setOption(option);



   </script>

</html>